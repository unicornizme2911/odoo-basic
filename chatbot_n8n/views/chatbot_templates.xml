<odoo>
    <data>
        <template id="chatbot_ui" name="Chatbot UI">
            <t t-call="web.layout">
                <t t-set="title">Chatbot</t>
                <div class="row mt-4" style="min-height: 600px">
                    <div class="col-3 border-end">
                        <h5>Conversations</h5>
                        <ul class="list-group">
                            <t t-foreach="conversations" t-as="s">
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    <a t-attf-href="/chatbot?conversation_id=#{s.id}" class="text-decoration-none"><t
                                            t-esc="s.name"/></a>
                                </li>
                            </t>
                        </ul>
                        <form method="post" t-attf-action="/chatbot/new" class="mt-3">
                            <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                            <button type="submit" class="btn btn-sm btn-secondary">+ New Chat</button>
                        </form>
                    </div>
                    <div class="col-9">
                        <h4><t t-esc="current_conversation.name if current_conversation else 'Chatbot Home'"/></h4>
                        <div id="chat-window"
                             style="border:1px solid #ccc; height:400px; overflow-y:auto; padding:1em;">
                            <t t-foreach="messages" t-as="msg">
                                <div t-attf-class="mb-2 text-#{msg.role == 'user' and 'end' or 'start'}">
                                    <div t-attf-class="p-2 rounded bg-#{msg.role == 'user' and 'primary' or 'light'} text-#{msg.role == 'user' and 'white' or 'dark'}">
                                        <t t-esc="msg.content"/>
                                    </div>
                                </div>
                            </t>
                        </div>
                        <div class="mt-3">
                            <input id="chat-input" class="form-control" placeholder="Type your message..."/>
                            <button id="send-btn" class="btn btn-primary mt-2">Send</button>
                        </div>

                    </div>
                </div>
                <script>
                    window.conversationId = <t t-esc="conversation_id if conversation_id else 'false'"/>;
                </script>
                <script type="text/javascript" src="/chatbot_n8n/static/src/js/chatbot.js"></script>
            </t>
        </template>
    </data>
</odoo>
